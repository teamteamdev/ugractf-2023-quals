# Qualification: Write-Up

Нам предоставляется APK-файл со встроенным внутри тестом. Описание таска неоднозначно намекает, что тест все же придется пройти.

## Шаг 1. Исследование

Установив apk на смартфон или эмулятор, видим следующую картину:

![](writeup/apk1.png)

После нажатия на кнопку «Начать» у нас есть тест. После случайного натыкивания ответов получаем дебажное сообщение об отправке на сервер:

![](writeup/apk2.png)

А после — и сертификат с результатом:

![](writeup/cert.png)

Логично предположить, что в поле «Проверочный код» будет флаг, если правильно решить тест.

## Шаг 2. Ковыряемся во внутренностях

Первым делом, видя apk, нужно попробовать покопаться в его начинке, вдруг что найдется. Делать мы это будем при помощи [apktool](https://ibotpeaches.github.io/Apktool/install/).

```bash
apktool d Qualification.apk
```

*Brotip:* Можно использовать очень удобный плагин [ApkLab](https://marketplace.visualstudio.com/items?itemName=Surendrajat.apklab) для VSCode.

Заглянув получившуюся папочку, видим кучу папок и директорий. Давайте посмотрим, что присходит в ресурсах:

```bash
cd ./Qualiication/res/values
ls
```

Видим, что есть несколько xml файлов, нас интересует `arrays.xml`:
```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string-array name="question_1">
        <item>За лицензирование какой деятельности не отвечает ФСБ России: Деятельность по работе со сведениями, составляющими государственную тайну, и по оказанию услуг по защите государственной тайны</item>
        <item>Деятельность по криптозащите информации</item>
        <item>Деятельность по технической защите конфиденциальной информации</item>
        <item>Деятельность по производству и разработке средств защиты конфиденциальной информации</item>
        <item>1</item>
    </string-array>
    <string-array name="question_10">
        <item>Одним из основных направлений защиты информации в ходе рекламной деятельности предприятия является:</item>
        <item>Постоянный контроль порядка распространения и содержания распространенных рекламных материалов в зависимости от способа, формы и периодичности их распространения</item>
        <item>Подготовка и экспертиза материалов, предназначенных для использования в рекламной деятельности, на предмет отсутствия в них информации с ограниченным доступом</item>
        <item>Нет правильного ответа</item>
        <item>2</item>
    </string-array>
    <string-array name="question_11">
        <item>В основные направления аналитической работы на предприятии входит:</item>
        <item>анализ возможных каналов несанкционированного доступа к информации моделирование потенциальных атак</item>
        <item>анализ внутренних и внешних угроз информационной безопасности предприятия</item>
        <item>анализ объекта защиты</item>
        <item>1</item>
    </string-array>
    ...
```

Тут расписаны все вопросы в следующем порядке:
```xml
<string-array name="question_{номер вопроса}">
    <item>{Вопрос}</item>
    <item>{Первый ответ}</item>
    <item>{Второй ответ}</item>
    <item>{Третий ответ}</item>
    <item>{номер правильного ответа}</item>
</string-array>
```

Теперь все что осталось — достать правильные ответы и натыкать их в приложении. Делаем это и получаем флаг.

Если интуиция вас подходит, можно декомпилировать и проверить, что четвёртый `item` — действительно номер правильного ответа:

1. Открываем APK в любом декомпиляторе (автор задания предпочитает JEB)
2. Находим QuestionFragment, в нем функцию `UpdateState`: ![](writeup/update-state.png)
3. Видим, что происходит сравнение выбранного ответа с тем, который в четвертом `<item>`
4. Чиним интуицию!

Флаг: **ugra_android_rev3r53_not_5o_easy_bu7_it_1s_c0o7_e6b1564f**
